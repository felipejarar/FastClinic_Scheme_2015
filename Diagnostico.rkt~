#lang racket

(require "FuncionesGenerales.rkt")
(require (planet neil/csv:2:0))

(define BDDiagnosticos (csv->list (open-input-file "Diagnostico.txt")))

;CONSTRUCTOR:
(define (createDiagnostico IDDiagnostico descripcionDiagnostico nivelGravedad)
        (if (and 
            (number? IDDiagnostico) 
            (> IDDiagnostico -1)       
            (string? descripcionDiagnostico)
            (string? nivelGravedad)
            )
            
            (list IDDiagnostico descripcionDiagnostico nivelGravedad)
            
            null
            
        )
     
  );FIN CONSTRUCTOR.

;FUNCIÓN DE PERTENENCIA:
(define (isDiagnostico? diagnostico)
  (if (list? diagnostico)
      (if (= (length diagnostico) 3)
          ;Si cumple
          (if (and
               (number? (car diagnostico))
               (string? (cadr diagnostico))
               (string? (caddr diagnostico))
              )
              
              #t
              
              #f
              
              ); fin de la sentecia if n°3.
          
          #f
          
          ); fin de la sentencia if n°2.
      
      #f
      
      ); fin de la sentencia if n°1.
 )

;SELECTORES:
(define (getIDDiagnostico diagnostico)
  (if (isDiagnostico? diagnostico)
      (car diagnostico)
      -1
      )
  )

(define (getDescripcionDiagnostico diagnostico)
  (if (isDiagnostico? diagnostico)
      (cadr diagnostico)
      -1
      )
  )

(define (getNivelGravedad diagnostico)
  (if (isDiagnostico? diagnostico)
      (caddr diagnostico)
      -1
      )
  )


